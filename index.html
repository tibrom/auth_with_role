<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Telegram Login Test</title>
  <script async src="https://telegram.org/js/telegram-widget.js?22"
    data-telegram-login="@chanell_extra_bot" 
    data-size="large"
    data-userpic="false"
    data-request-access="write"
    data-onauth="onTelegramAuth(user)">
  </script>
</head>
<body>
  <h2>Войти через Telegram</h2>

  <script>
    async function onTelegramAuth(user) {
      console.log("Received Telegram user:", user);

      const response = await fetch('https://extrabot.ru/auth/integration/telegram/auth', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(user)
      });

      if (response.ok) {
        const data = await response.json();
        console.log('Авторизация успешна!', data);
        alert("Успех! Access Token: " + data.access_token);
      } else {
        console.error('Ошибка авторизации');
        alert("Ошибка авторизации");
      }
    }
  </script>
</body>
</html>
